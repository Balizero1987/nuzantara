# LIVING ARCHITECTURE

*Auto-generated by The Scribe on 2025-12-05 01:26:59*

> **Note:** This document is automatically updated. Do not edit manually.

---

## Table of Contents

- [API Endpoints](#api-endpoints)
- [Modules](#modules)
- [Services](#services)
- [Agents](#agents)

---

## API Endpoints

### 

#### `GET /api/intel/critical`

Get critical impact items

**File:** `app/routers/intel.py`

---

#### `GET /api/intel/stats/{collection}`

Get statistics for a specific intel collection

**File:** `app/routers/intel.py`

---

#### `GET /api/intel/trends`

Get trending topics and keywords

**File:** `app/routers/intel.py`

---

#### `POST /api/intel/search`

Search intel news with semantic search

**File:** `app/routers/intel.py`

---

#### `POST /api/intel/store`

Store intel news item in Qdrant

**File:** `app/routers/intel.py`

---

### Oracle INGEST

#### `GET /api/oracle/collections`

List all available collections

**Returns:**
- List of collection names
- Document counts for each collection

**File:** `app/routers/oracle_ingest.py`

---

#### `POST /api/oracle/ingest`

Bulk ingest documents into Qdrant collection

**Usage:**
```python
import requests

chunks = [
    {
        "content": "### PP-28-2025 - Pasal 1\n\nContent here...",
        "metadata": {
            "law_id": "PP-28-2025",
            "pasal": "1",
            "category": "business_licensing",
            "type": "legal_regulation"
        }
    }
]

response = requests.post(
    "https://nuzantara-rag.fly.dev/api/oracle/ingest",
    json={"collection": "legal_intelligence", "documents": chunks}
)
```

**Rate Limits:**
- Max 1000 documents per request
- Batch processing for large uploads

**Response Model:** `IngestResponse`

**File:** `app/routers/oracle_ingest.py`

---

### Oracle v5.3 - Ultra Hybrid

#### `GET /api/oracle/drive/test`

Test Google Drive integration

**File:** `app/routers/oracle_universal.py`

---

#### `GET /api/oracle/gemini/test`

Test Google Gemini integration

**File:** `app/routers/oracle_universal.py`

---

#### `GET /api/oracle/health`

Health check for Oracle v5.3 services
Verifies all integrated components are operational

**File:** `app/routers/oracle_universal.py`

---

#### `GET /api/oracle/personalities`

Get available AI personalities

**File:** `app/routers/oracle_universal.py`

---

#### `GET /api/oracle/user/profile/{user_email}`

Get user profile with localization preferences
Integrates with PostgreSQL user management system

**File:** `app/routers/oracle_universal.py`

---

#### `POST /api/oracle/feedback`

Submit user feedback for continuous learning and system improvement
Stores feedback for training data and model refinement

**File:** `app/routers/oracle_universal.py`

---

#### `POST /api/oracle/personality/test`

Test a specific personality

**File:** `app/routers/oracle_universal.py`

---

#### `POST /api/oracle/query`

Ultra Hybrid Oracle Query - v5.3

Integrates Qdrant search, Google Drive, and Gemini reasoning
with full user localization and context awareness

**Response Model:** `OracleQueryResponse`

**File:** `app/routers/oracle_universal.py`

---

### agentic-functions

#### `GET /api/agents/analytics/summary`

Get comprehensive analytics for all agentic functions

Performance: Cached for 3 minutes (reduces database load)

**File:** `app/routers/agents.py`

---

#### `GET /api/agents/compliance/alerts`

Get upcoming compliance alerts

Args:
    client_id: Filter by client
    severity: Filter by severity
    auto_notify: Automatically send notifications for alerts

**File:** `app/routers/agents.py`

---

#### `GET /api/agents/compliance/client/{client_id}`

Get all compliance items for a client

**File:** `app/routers/agents.py`

---

#### `GET /api/agents/ingestion/status`

Get status of automatic ingestion service

**File:** `app/routers/agents.py`

---

#### `GET /api/agents/journey/{journey_id}`

Get journey details and progress

**File:** `app/routers/agents.py`

---

#### `GET /api/agents/journey/{journey_id}/next-steps`

Get next available steps in the journey

**File:** `app/routers/agents.py`

---

#### `GET /api/agents/knowledge-graph/export`

Export knowledge graph in Neo4j-ready format

âš ï¸ PLACEHOLDER ENDPOINT: Service not implemented
Knowledge Graph builder exists but export functionality is not wired.

Formats:
- neo4j: Cypher queries for Neo4j
- json: JSON format
- graphml: GraphML format

**File:** `app/routers/agents.py`

---

#### `GET /api/agents/status`

Get status of all 10 agentic functions

Returns:
    Overall system status and capabilities

Performance: Cached for 5 minutes (90% faster on cache hit)

**File:** `app/routers/agents.py`

---

#### `POST /api/agents/compliance/track`

âš ï¸ AGENT 2: Proactive Compliance Monitor

Track compliance deadlines and get automatic alerts (60/30/7 days before)

Supported types:
- visa_expiry: KITAS, KITAP, passport expiry
- tax_filing: SPT Tahunan, PPh, PPn deadlines
- license_renewal: IMTA, NIB, business permits
- regulatory_change: Law/regulation changes

**File:** `app/routers/agents.py`

---

#### `POST /api/agents/ingestion/run`

ðŸ¤– AGENT 4: Auto Ingestion Orchestrator

âš ï¸ PLACEHOLDER ENDPOINT: Service exists but not wired into main_cloud.py
The AutoIngestionOrchestrator service is implemented but not initialized.

Automatically monitor and ingest updates from government sources

Sources:
- https://jdih.kemenkeu.go.id (Tax regulations)
- https://peraturan.bpk.go.id (Legal documents)
- https://jdih.kemendag.go.id (Trade regulations)
- https://ortax.org (Tax news)

**File:** `app/routers/agents.py`

---

#### `POST /api/agents/journey/create`

ðŸŽ¯ AGENT 1: Client Journey Orchestrator

Create a new multi-step client journey with automatic progress tracking

Example journeys:
- pt_pma_setup: Complete PT PMA company setup (7 steps)
- kitas_application: KITAS visa application (5 steps)
- property_purchase: Property purchase process (6 steps)

**File:** `app/routers/agents.py`

---

#### `POST /api/agents/journey/{journey_id}/step/{step_id}/complete`

Mark a journey step as completed

**File:** `app/routers/agents.py`

---

#### `POST /api/agents/knowledge-graph/extract`

ðŸ§  AGENT 3: Knowledge Graph Builder

Extract entities and relationships from text to build knowledge graph.

Entities: Person, Organization, Location, Document, Concept
Relationships: WORKS_FOR, LOCATED_IN, REQUIRES, RELATED_TO, etc.

**File:** `app/routers/agents.py`

---

#### `POST /api/agents/pricing/calculate`

ðŸ’° AGENT 6: Dynamic Pricing Service

Calculate pricing based on service type, complexity, and urgency

**File:** `app/routers/agents.py`

---

#### `POST /api/agents/research/autonomous`

ðŸ”¬ AGENT 7: Autonomous Research Service

Self-directed research agent that iteratively explores Qdrant collections
to answer complex or ambiguous queries without human intervention.

Example: "How to open a crypto company in Indonesia?"
â†’ Iteration 1: Search kbli_eye â†’ "crypto" not in KBLI
â†’ Iteration 2: Expand to legal_updates â†’ finds OJK crypto regulation
â†’ Iteration 3: Search tax_genius â†’ crypto tax treatment
â†’ Synthesis: Comprehensive answer

Args:
    topic: Research topic/question
    depth: standard (3 iterations), deep (5 iterations)
    sources: Optional list of specific collections to search

**File:** `app/routers/agents.py`

---

#### `POST /api/agents/synthesis/cross-oracle`

ðŸ” AGENT 5: Cross-Oracle Synthesis

Search across multiple Oracle collections and synthesize integrated recommendations.

Example: "I want to open a restaurant in Canggu"
â†’ Queries: kbli_eye, legal_architect, tax_genius, visa_oracle, property_knowledge
â†’ Synthesizes: Integrated plan with KBLI code, legal structure, tax obligations, etc.

**File:** `app/routers/agents.py`

---

### authentication

#### `GET /api/auth/check`

Check if current session is valid

**File:** `app/routers/auth.py`

---

#### `GET /api/auth/csrf-token`

Generate CSRF token and session ID for frontend security.
Returns token in both JSON body and response headers.

**File:** `app/routers/auth.py`

---

#### `GET /api/auth/profile`

Get current user profile

**Response Model:** `UserProfile`

**File:** `app/routers/auth.py`

---

#### `POST /api/auth/login`

User login with email and PIN

Returns JWT token and user profile on successful authentication

**Response Model:** `LoginResponse`

**File:** `app/routers/auth.py`

---

#### `POST /api/auth/logout`

Logout user (server-side token invalidation would go here)

**File:** `app/routers/auth.py`

---

### autonomous-tier1

#### `GET /api/autonomous-agents/executions`

List recent agent executions

Args:
    limit: Maximum number of executions to return (default: 20)

Returns:
    List of recent executions

**File:** `app/routers/autonomous_agents.py`

---

#### `GET /api/autonomous-agents/executions/{execution_id}`

Get status of a specific agent execution

Args:
    execution_id: Execution ID returned by agent run endpoint

Returns:
    Execution details and result

**Response Model:** `AgentExecutionResponse`

**File:** `app/routers/autonomous_agents.py`

---

#### `GET /api/autonomous-agents/status`

Get status of all Tier 1 autonomous agents

Returns:
    Agent capabilities and recent executions

**File:** `app/routers/autonomous_agents.py`

---

#### `POST /api/autonomous-agents/client-value-predictor/run`

ðŸ’° Run Client LTV Predictor & Nurturing Agent

Scores all clients and sends personalized nurturing messages to:
- VIP clients (LTV > 80)
- High-risk clients (LTV < 30 and inactive > 30 days)

Returns:
    Execution status (agent runs in background)

**Response Model:** `AgentExecutionResponse`

**File:** `app/routers/autonomous_agents.py`

---

#### `POST /api/autonomous-agents/conversation-trainer/run`

ðŸ¤– Run Conversation Quality Trainer Agent

Analyzes high-rated conversations and generates prompt improvements

Args:
    days_back: Number of days to look back for conversations (default: 7)

Returns:
    Execution status (agent runs in background)

**Response Model:** `AgentExecutionResponse`

**File:** `app/routers/autonomous_agents.py`

---

#### `POST /api/autonomous-agents/knowledge-graph-builder/run`

ðŸ•¸ï¸ Run Knowledge Graph Builder Agent

Extracts entities and relationships from conversations and builds knowledge graph

Args:
    days_back: Number of days to look back for conversations (default: 30)
    init_schema: Initialize database schema (default: False)

Returns:
    Execution status (agent runs in background)

**Response Model:** `AgentExecutionResponse`

**File:** `app/routers/autonomous_agents.py`

---

### conversations

#### `DELETE /api/bali-zero/conversations/clear`

Clear conversation history for the authenticated user

SECURITY: User identity is extracted from JWT token.

Query params:
- session_id: Optional session filter (if omitted, clears ALL conversations for user)

**File:** `app/routers/conversations.py`

---

#### `GET /api/bali-zero/conversations/history`

Get conversation history for the authenticated user

SECURITY: User identity is extracted from JWT token.

Query params:
- limit: Max number of messages to return (default: 20)
- session_id: Optional session filter

**File:** `app/routers/conversations.py`

---

#### `GET /api/bali-zero/conversations/stats`

Get conversation statistics for the authenticated user

SECURITY: User identity is extracted from JWT token.

**File:** `app/routers/conversations.py`

---

#### `POST /api/bali-zero/conversations/save`

Save conversation messages to PostgreSQL
+ Auto-populate CRM with client/practice data

SECURITY: User identity is extracted from JWT token, not request body.

Body:
{
    "messages": [{"role": "user", "content": "..."}, ...],
    "session_id": "optional-session-id",
    "metadata": {"key": "value"}
}

Returns:
{
    "success": true,
    "conversation_id": 123,
    "messages_saved": 10,
    "user_email": "authenticated-user@example.com",
    "crm": {
        "processed": true,
        "client_id": 42,
        "client_created": false,
        "client_updated": true,
        "practice_id": 15,
        "practice_created": true,
        "interaction_id": 88
    }
}

**File:** `app/routers/conversations.py`

---

### crm-clients

#### `DELETE /api/crm/clients/{client_id}`

Delete a client (soft delete - marks as inactive)

This doesn't permanently delete the client, just marks them as inactive.
Use with caution as this will also affect related practices and interactions.

**File:** `app/routers/crm_clients.py`

---

#### `GET /api/crm/clients/`

List all clients with optional filtering

- **status**: Filter by client status
- **assigned_to**: Filter by assigned team member
- **search**: Search in name, email, phone fields
- **limit**: Max results (default: 50, max: 200)
- **offset**: For pagination

**File:** `app/routers/crm_clients.py`

---

#### `GET /api/crm/clients/by-email/{email}`

Get client by email address

**File:** `app/routers/crm_clients.py`

---

#### `GET /api/crm/clients/stats/overview`

Get overall client statistics

Returns counts by status, top assigned team members, etc.

**File:** `app/routers/crm_clients.py`

---

#### `GET /api/crm/clients/{client_id}`

Get client by ID

**Response Model:** `ClientResponse`

**File:** `app/routers/crm_clients.py`

---

#### `GET /api/crm/clients/{client_id}/summary`

Get comprehensive client summary including:
- Basic client info
- All practices (active + completed)
- Recent interactions
- Documents
- Upcoming renewals

**File:** `app/routers/crm_clients.py`

---

#### `PATCH /api/crm/clients/{client_id}`

Update client information

Only provided fields will be updated. Other fields remain unchanged.

**Response Model:** `ClientResponse`

**File:** `app/routers/crm_clients.py`

---

#### `POST /api/crm/clients/`

Create a new client

- **full_name**: Client's full name (required)
- **email**: Email address (optional but recommended)
- **phone**: Phone number
- **whatsapp**: WhatsApp number (can be same as phone)
- **nationality**: Client's nationality
- **passport_number**: Passport number
- **assigned_to**: Team member email to assign client to
- **tags**: Array of tags (e.g., ['vip', 'urgent'])

**Response Model:** `ClientResponse`

**File:** `app/routers/crm_clients.py`

---

### crm-interactions

#### `GET /api/crm/interactions/`

List interactions with optional filtering

**File:** `app/routers/crm_interactions.py`

---

#### `GET /api/crm/interactions/client/{client_id}/timeline`

Get complete interaction timeline for a client

Returns all interactions sorted by date (newest first)

**File:** `app/routers/crm_interactions.py`

---

#### `GET /api/crm/interactions/practice/{practice_id}/history`

Get all interactions related to a specific practice

Useful for tracking communication history for a KITAS, PT PMA, etc.

**File:** `app/routers/crm_interactions.py`

---

#### `GET /api/crm/interactions/stats/overview`

Get interaction statistics

- Total interactions
- By type (chat, email, call, etc.)
- By sentiment
- By team member

**File:** `app/routers/crm_interactions.py`

---

#### `GET /api/crm/interactions/{interaction_id}`

Get full interaction details by ID

**File:** `app/routers/crm_interactions.py`

---

#### `POST /api/crm/interactions/`

Log a new interaction

**Types:**
- chat: Web chat conversation
- email: Email exchange
- whatsapp: WhatsApp message
- call: Phone call
- meeting: In-person or video meeting
- note: Internal note/comment

**Channels:**
- web_chat: ZANTARA chat widget
- gmail: Gmail integration
- whatsapp: WhatsApp Business
- phone: Phone call
- in_person: Face-to-face meeting

**Response Model:** `InteractionResponse`

**File:** `app/routers/crm_interactions.py`

---

#### `POST /api/crm/interactions/from-conversation`

Auto-create interaction record from a chat conversation

This is called automatically when a chat session ends or at intervals

**File:** `app/routers/crm_interactions.py`

---

#### `POST /api/crm/interactions/sync-gmail`

Manually trigger Gmail sync to Auto-CRM

**File:** `app/routers/crm_interactions.py`

---

### crm-practices

#### `GET /api/crm/practices/`

List practices with optional filtering

Returns practices with client and practice type information joined

**File:** `app/routers/crm_practices.py`

---

#### `GET /api/crm/practices/active`

Get all active practices (in progress, not completed/cancelled)

Optionally filter by assigned team member

**File:** `app/routers/crm_practices.py`

---

#### `GET /api/crm/practices/renewals/upcoming`

Get practices with upcoming renewal dates

Default: next 90 days

**File:** `app/routers/crm_practices.py`

---

#### `GET /api/crm/practices/stats/overview`

Get overall practice statistics

- Counts by status
- Counts by practice type
- Revenue metrics

**File:** `app/routers/crm_practices.py`

---

#### `GET /api/crm/practices/{practice_id}`

Get practice details by ID with full client and type info

**File:** `app/routers/crm_practices.py`

---

#### `PATCH /api/crm/practices/{practice_id}`

Update practice information

Common status values:
- inquiry
- quotation_sent
- payment_pending
- in_progress
- waiting_documents
- submitted_to_gov
- approved
- completed
- cancelled

**File:** `app/routers/crm_practices.py`

---

#### `POST /api/crm/practices/`

Create a new practice for a client

- **client_id**: ID of the client
- **practice_type_code**: Practice type code (retrieved from database)
- **status**: Initial status (default: 'inquiry')
- **quoted_price**: Price quoted to client
- **assigned_to**: Team member email to handle this

**Response Model:** `PracticeResponse`

**File:** `app/routers/crm_practices.py`

---

#### `POST /api/crm/practices/{practice_id}/documents/add`

Add a document to a practice

- **document_name**: Name/type of document (e.g., "Passport Copy")
- **drive_file_id**: Google Drive file ID
- **uploaded_by**: Email of person uploading

**File:** `app/routers/crm_practices.py`

---

### crm-shared-memory

#### `GET /api/crm/shared-memory/client/{client_id}/full-context`

Get complete context for a client
Everything the AI needs to know about this client

Returns:
- Client info
- All practices (active + completed)
- Recent interactions (last 20)
- Upcoming renewals
- Action items

**File:** `app/routers/crm_shared_memory.py`

---

#### `GET /api/crm/shared-memory/search`

Natural language search across CRM data

Examples:
- "clients with KITAS expiring soon"
- "active practices for John Smith"
- "recent interactions with antonello@balizero.com"
- "urgent practices"
- "PT PMA practices in progress"

Returns relevant results from clients, practices, and interactions

**File:** `app/routers/crm_shared_memory.py`

---

#### `GET /api/crm/shared-memory/team-overview`

Get team-wide CRM overview

Perfect for dashboard or team queries like:
- "How many active practices do we have?"
- "What's our workload distribution?"
- "Recent activity summary"

**File:** `app/routers/crm_shared_memory.py`

---

#### `GET /api/crm/shared-memory/upcoming-renewals`

Get all practices with upcoming renewal dates

Default: next 90 days

**File:** `app/routers/crm_shared_memory.py`

---

### handlers

#### `GET /api/handlers/category/{category}`

Get all handlers in a specific category

**File:** `app/routers/handlers.py`

---

#### `GET /api/handlers/list`

Returns complete registry of all available handlers
This is the master catalog that ZANTARA uses to see all available tools

**File:** `app/routers/handlers.py`

---

#### `GET /api/handlers/search`

Search handlers by name, path, or description

**File:** `app/routers/handlers.py`

---

### health

#### `GET /health`

System health check - Non-blocking during startup.

Returns "initializing" immediately if service not ready.
Prevents container crashes during warmup by not creating heavy objects.

**Response Model:** `HealthResponse`

**File:** `app/routers/health.py`

---

#### `GET /health/`

System health check - Non-blocking during startup.

Returns "initializing" immediately if service not ready.
Prevents container crashes during warmup by not creating heavy objects.

**Response Model:** `HealthResponse`

**File:** `app/routers/health.py`

---

#### `GET /health/debug/config`

TEMPORARY: Debug endpoint to check loaded configuration.
Shows what API keys and config the backend actually loaded.

**File:** `app/routers/health.py`

---

#### `GET /health/detailed`

Detailed health check showing all service statuses.

Returns comprehensive information about each service for debugging
and monitoring purposes. Includes:
- Individual service status (healthy/degraded/unavailable)
- Error messages for failed services
- Database connectivity check
- Overall system health assessment

Returns:
    dict: Detailed health status with per-service breakdown

**File:** `app/routers/health.py`

---

#### `GET /health/live`

Kubernetes-style liveness probe.

Returns 200 if the application is running (even if not fully ready).
Used by orchestrators to determine if instance needs restart.

Returns:
    dict: Liveness status

**File:** `app/routers/health.py`

---

#### `GET /health/ready`

Kubernetes-style readiness probe.

Returns 200 only if critical services are ready to handle traffic.
Used by load balancers to determine if instance should receive traffic.

Returns:
    dict: Readiness status with critical service check

**File:** `app/routers/health.py`

---

### identity

#### `POST /team/login`

Team member login endpoint

Replicates the exact behavior of Node.js /api/auth/team/login endpoint.

- Validates email and PIN format
- Authenticates user against database
- Generates JWT token (7 days expiry)
- Returns user data and permissions

Returns:
    LoginResponse with JWT token and user data

**Response Model:** `LoginResponse`

**File:** `app/modules/identity/router.py`

---

### image

#### `POST /api/v1/image/generate`

Generate images using Google Imagen API

Args:
    request: Image generation request with prompt and parameters

Returns:
    ImageGenerationResponse with generated images or error

**Response Model:** `ImageGenerationResponse`

**File:** `app/routers/image_generation.py`

---

### ingestion

#### `GET /api/ingest/stats`

Get current database statistics.

Returns total documents, tier distribution, and collection info.

**File:** `app/routers/ingest.py`

---

#### `POST /api/ingest/batch`

Process all books in a directory.

- **directory_path**: Path to directory containing books
- **file_patterns**: File patterns to match (default: ["*.pdf", "*.epub"])
- **skip_existing**: Skip books already in database

**Response Model:** `BatchIngestionResponse`

**File:** `app/routers/ingest.py`

---

#### `POST /api/ingest/file`

Ingest a book from local file path.

- **file_path**: Path to PDF or EPUB file
- **title**: Optional book title
- **author**: Optional author name
- **tier_override**: Optional manual tier classification

**Response Model:** `BookIngestionResponse`

**File:** `app/routers/ingest.py`

---

#### `POST /api/ingest/upload`

Upload and ingest a single book.

- **file**: PDF or EPUB file
- **title**: Optional book title (auto-detected if not provided)
- **author**: Optional author name
- **tier_override**: Optional manual tier (S/A/B/C/D)

**Response Model:** `BookIngestionResponse`

**File:** `app/routers/ingest.py`

---

### instagram

#### `GET /webhook/instagram`

Meta Webhook Verification Endpoint

**File:** `app/routers/instagram.py`

---

#### `POST /webhook/instagram`

Handle incoming Instagram messages

**File:** `app/routers/instagram.py`

---

### knowledge

#### `GET /api/search/health`

Quick health check for search service

**File:** `app/modules/knowledge/router.py`

---

#### `POST /api/search/`

Semantic search with tier-based access control.

- **query**: Search query text
- **level**: User access level (0-3)
- **limit**: Maximum results (1-50, default 5)
- **tier_filter**: Optional specific tier filter

Returns relevant book chunks filtered by user's access level.

**Response Model:** `SearchResponse`

**File:** `app/modules/knowledge/router.py`

---

### legal-ingestion

#### `GET /api/legal/collections/stats`

Get statistics for legal document collection.

Args:
    collection_name: Collection name to query

Returns:
    Collection statistics

**File:** `app/routers/legal_ingest.py`

---

#### `POST /api/legal/ingest`

Ingest a single legal document through the specialized pipeline.

Pipeline stages:
1. Clean: Remove headers/footers/noise
2. Extract Metadata: Type, number, year, topic
3. Parse Structure: BAB, Pasal, Ayat hierarchy
4. Chunk: Pasal-aware chunking with context injection
5. Embed & Store: Generate embeddings and store in Qdrant

Args:
    request: Legal ingestion request with file path and options

Returns:
    Ingestion result with metadata and statistics

**Response Model:** `LegalIngestResponse`

**File:** `app/routers/legal_ingest.py`

---

#### `POST /api/legal/ingest-batch`

Ingest multiple legal documents in batch.

Args:
    file_paths: List of file paths to ingest
    collection_name: Override collection name (optional)

Returns:
    Batch ingestion results

**File:** `app/routers/legal_ingest.py`

---

### media

#### `POST /media/generate-image`

Generate an image from a text prompt.

**File:** `app/routers/media.py`

---

### memory

#### `DELETE /api/memory/{memory_id}`

Delete memory from vector store

**File:** `app/routers/memory_vector.py`

---

#### `GET /api/memory/health`

Health check for memory vector service

**File:** `app/routers/memory_vector.py`

---

#### `GET /api/memory/stats`

Get memory collection statistics

**File:** `app/routers/memory_vector.py`

---

#### `POST /api/memory/embed`

Generate embedding for text.
Uses sentence-transformers (FREE, local) by default.

**Response Model:** `EmbedResponse`

**File:** `app/routers/memory_vector.py`

---

#### `POST /api/memory/init`

Reinitialize the semantic memory collection after deployments or resets.

**Response Model:** `InitResponse`

**File:** `app/routers/memory_vector.py`

---

#### `POST /api/memory/search`

Semantic search across all memories using vector similarity.

Supports metadata filtering:
- userId: Filter by specific user
- entities: Filter by entity (use {"entities": {"$contains": "zero"}})

**Response Model:** `MemorySearchResponse`

**File:** `app/routers/memory_vector.py`

---

#### `POST /api/memory/similar`

Find memories similar to a given memory.
Uses the stored memory's embedding to find neighbors.

**Response Model:** `MemorySearchResponse`

**File:** `app/routers/memory_vector.py`

---

#### `POST /api/memory/store`

Store memory in Qdrant for semantic search.

Metadata should include:
- userId: User ID
- type: Memory type (profile, expertise, event, etc)
- timestamp: ISO timestamp
- entities: Comma-separated entities

**File:** `app/routers/memory_vector.py`

---

### notifications

#### `GET /api/notifications/status`

Get notification hub status and available channels

**File:** `app/routers/notifications.py`

---

#### `GET /api/notifications/templates`

List all available notification templates

**File:** `app/routers/notifications.py`

---

#### `POST /api/notifications/send`

Send a custom notification

Auto-selects channels based on priority:
- low: In-app only
- normal: Email + In-app
- high: Email + WhatsApp + In-app
- urgent: Email + WhatsApp + SMS + In-app
- critical: All channels

**File:** `app/routers/notifications.py`

---

#### `POST /api/notifications/send-template`

Send notification using a predefined template

Available templates:
- compliance_60_days: 60-day compliance reminder
- compliance_30_days: 30-day compliance alert
- compliance_7_days: 7-day urgent compliance alert
- journey_step_completed: Journey step completion
- journey_completed: Journey completion celebration
- document_request: Document request
- payment_reminder: Payment reminder

**File:** `app/routers/notifications.py`

---

#### `POST /api/notifications/test`

Test notification channels with a test message

Useful for verifying configuration

**File:** `app/routers/notifications.py`

---

### plugins

#### `GET /api/plugins/health`

Health check endpoint

**File:** `api/plugins.py`

---

#### `GET /api/plugins/list`

List all available plugins

Query Parameters:
- category: Filter by category
- tags: Filter by tags (comma-separated)
- allowed_models: Filter by allowed models (comma-separated)

**File:** `api/plugins.py`

---

#### `GET /api/plugins/metrics/all`

Get metrics for all plugins

**File:** `api/plugins.py`

---

#### `GET /api/plugins/statistics`

Get plugin registry statistics

**File:** `api/plugins.py`

---

#### `GET /api/plugins/tools/anthropic`

Get plugin definitions in ZANTARA AI tool format (legacy Anthropic format for compatibility)

Query Parameters:
- model: Filter by model (haiku, sonnet, opus)

**File:** `api/plugins.py`

---

#### `GET /api/plugins/{plugin_name}`

Get plugin details

Path Parameters:
- plugin_name: Plugin name or alias

**File:** `api/plugins.py`

---

#### `GET /api/plugins/{plugin_name}/metrics`

Get plugin performance metrics

Path Parameters:
- plugin_name: Plugin name

**File:** `api/plugins.py`

---

#### `POST /api/plugins/search`

Search plugins by name, description, or tags

Body:
- query: Search query string

**File:** `api/plugins.py`

---

#### `POST /api/plugins/{plugin_name}/execute`

Execute a plugin

Path Parameters:
- plugin_name: Plugin name or alias

Headers:
- x-user-id: User ID for auth and rate limiting

Body:
- input_data: Plugin input data
- use_cache: Whether to use caching (default: true)
- user_id: User ID (alternative to header)

**File:** `api/plugins.py`

---

#### `POST /api/plugins/{plugin_name}/reload`

Hot-reload a plugin (admin only)

Path Parameters:
- plugin_name: Plugin name to reload

Headers:
- x-admin-key: Admin API key

**File:** `api/plugins.py`

---

### productivity

#### `GET /api/productivity/calendar/events`

List upcoming calendar events

**File:** `app/routers/productivity.py`

---

#### `GET /api/productivity/drive/search`

Search Google Drive files

**File:** `app/routers/productivity.py`

---

#### `POST /api/productivity/calendar/schedule`

Schedule a meeting in Google Calendar

**File:** `app/routers/productivity.py`

---

#### `POST /api/productivity/gmail/draft`

Draft an email in Gmail

**File:** `app/routers/productivity.py`

---

### search

#### `GET /api/search/health`

Quick health check for search service

**File:** `app/routers/search.py`

---

#### `POST /api/search/`

Semantic search with tier-based access control.

- **query**: Search query text
- **level**: User access level (0-3)
- **limit**: Maximum results (1-50, default 5)
- **tier_filter**: Optional specific tier filter

Returns relevant book chunks filtered by user's access level.

**Response Model:** `SearchResponse`

**File:** `app/routers/search.py`

---

### team-activity

#### `GET /api/team/activity/monthly`

Get monthly work summary (ADMIN ONLY)

Returns total hours, days worked, and averages for each team member.

**File:** `app/routers/team_activity.py`

---

#### `GET /api/team/activity/weekly`

Get weekly work summary (ADMIN ONLY)

Returns total hours, days worked, and averages for each team member.

**File:** `app/routers/team_activity.py`

---

#### `GET /api/team/export`

Export timesheet data (ADMIN ONLY)

Returns CSV file with all work hours in the specified date range.

**File:** `app/routers/team_activity.py`

---

#### `GET /api/team/health`

Health check for team activity service

**File:** `app/routers/team_activity.py`

---

#### `GET /api/team/hours`

Get work hours for a specific date (ADMIN ONLY)

Returns all team members' work hours for the specified date.

**File:** `app/routers/team_activity.py`

---

#### `GET /api/team/my-status`

Get my current work status

Returns:
- Current online/offline status
- Today's hours worked
- This week's summary

**Response Model:** `UserStatusResponse`

**File:** `app/routers/team_activity.py`

---

#### `GET /api/team/status`

Get current online status of all team members (ADMIN ONLY)

Shows who is currently clocked in and who is offline.

**File:** `app/routers/team_activity.py`

---

#### `POST /api/team/clock-in`

Clock in for work day

Team members use this to start their work day.
One clock-in per day allowed.

**Response Model:** `ClockResponse`

**File:** `app/routers/team_activity.py`

---

#### `POST /api/team/clock-out`

Clock out for work day

Team members use this to end their work day.
Must be clocked in first.

**Response Model:** `ClockResponse`

**File:** `app/routers/team_activity.py`

---

### whatsapp

#### `GET /webhook/whatsapp`

Meta Webhook Verification Endpoint

**File:** `app/routers/whatsapp.py`

---

#### `POST /webhook/whatsapp`

Handle incoming WhatsApp messages

**File:** `app/routers/whatsapp.py`

---

## Modules

### Agents

#### `agents.__init__`

Agents Module - Autonomous Agent Framework
Contains agent implementations for conversation training, client prediction, and knowledge graph building.

#### `agents.agents.__init__`

Agents Submodule - Individual Agent Implementations
Contains the core agent classes for different autonomous functions.

#### `agents.agents.client_value_predictor`

ðŸ’° CLIENT LIFETIME VALUE PREDICTOR
Predicts high-value clients and automatically nurtures them

#### `agents.agents.conversation_trainer`

ðŸ¤– AUTONOMOUS CONVERSATION TRAINER
Learns from successful conversations and improves prompts automatically

#### `agents.agents.knowledge_graph_builder`

ðŸ•¸ï¸ KNOWLEDGE GRAPH AUTO-BUILDER
Automatically builds and maintains a knowledge graph from all data sources

#### `agents.run_client_predictor`

Client Value Predictor - Standalone Runner
Usage: python run_client_predictor.py

#### `agents.run_conversation_trainer`

Conversation Trainer - Standalone Runner
Usage: python run_conversation_trainer.py [--days DAYS]

#### `agents.run_knowledge_graph`

Knowledge Graph Builder - Standalone Runner
Usage: python run_knowledge_graph.py [--days DAYS] [--init-schema]

### Api

#### `api.plugins`

Plugin API Routes - FastAPI

Provides REST API for plugin management and execution.

### App

#### `app.__init__`

ZANTARA RAG System - FastAPI Application

#### `app.config`

ZANTARA RAG - Configuration Management (DEPRECATED)
This file is kept for backward compatibility.
All new code should use app.core.config.settings

#### `app.core.__init__`

NUZANTARA PRIME - Core Module
Centralized configuration and core utilities

#### `app.core.config`

NUZANTARA PRIME - Centralized Configuration
All environment variables centralized using pydantic-settings

#### `app.core.service_health`

ZANTARA RAG - Service Health Registry

Provides centralized tracking of service health status for fail-fast behavior
and health-based degradation in production environments.

#### `app.decorators.auth`

Authentication Decorators
Provides decorators for endpoint security classification and access control

#### `app.dependencies`

FastAPI Dependency Injection

Centralized dependencies for all routers to avoid circular imports.
Provides fail-fast behavior with clear error messages for service unavailability.

Note: Qdrant references are legacy - system now uses Qdrant exclusively.

#### `app.feature_flags`

ZANTARA Feature Flags
Control experimental and optional features via environment variables

#### `app.main_cloud`

FastAPI entrypoint for the ZANTARA RAG backend.

Responsibilities:
* Initialize shared services (SearchService, ZantaraAI, ToolExecutor)
* Mount all API routers
* Expose streaming endpoint (/bali-zero/chat-stream)
* Configure CORS and health checks

#### `app.metrics`

Enhanced Prometheus Metrics for ZANTARA-PERFECT-100
Provides detailed system monitoring and performance tracking

#### `app.models`

ZANTARA RAG - Pydantic Models

#### `app.modules.identity.__init__`

NUZANTARA PRIME - Identity Module
Authentication, Users, and Sessions management

#### `app.modules.identity.models`

NUZANTARA PRIME - Identity Module Data Layer
SQLModel models mapping to existing Node.js backend tables

#### `app.modules.identity.router`

NUZANTARA PRIME - Identity Router
HTTP API endpoints for authentication

#### `app.modules.identity.service`

NUZANTARA PRIME - Identity Service
Business logic for authentication and user management

#### `app.modules.knowledge.__init__`

NUZANTARA PRIME - Knowledge Module
RAG, Search, and Vector Database Interface

#### `app.modules.knowledge.router`

NUZANTARA PRIME - Knowledge Router
HTTP interface for RAG/Search operations

#### `app.modules.knowledge.service`

NUZANTARA PRIME - Knowledge Service
Business logic for RAG, Search, and Vector Database operations

#### `app.routers.__init__`

ZANTARA RAG - API Routers

#### `app.routers.agents`

ZANTARA Agentic Functions Router
Exposes all 10 advanced agentic capabilities as REST API endpoints

Phase 1-2: Foundation Agents (6)
Phase 3: Orchestration Agents (2)
Phase 4: Advanced Intelligence (1)
Phase 5: Automation (1)

Performance Optimizations:
- Redis caching (5 min TTL for status endpoints)
- Rate limiting (prevents abuse)
- Request deduplication

SECURITY: All endpoints require authentication (added 2025-12-03)

#### `app.routers.auth`

JWT Authentication Router
Real email+PIN authentication using bcrypt and JWT tokens

#### `app.routers.autonomous_agents`

TIER 1 AUTONOMOUS AGENTS - HTTP Endpoints
Provides HTTP API for orchestrator to trigger autonomous agents

Agents:
1. Conversation Quality Trainer
2. Client LTV Predictor & Nurturing
3. Knowledge Graph Builder

#### `app.routers.conversations`

ZANTARA Conversations Router
Endpoints for persistent conversation history with PostgreSQL
+ Auto-CRM population from conversations

SECURITY: All endpoints require JWT authentication (added 2025-12-03)
User identity is taken from JWT token, NOT from request parameters.

#### `app.routers.crm_clients`

ZANTARA CRM - Clients Management Router
Endpoints for managing client data (anagrafica clienti)

#### `app.routers.crm_interactions`

ZANTARA CRM - Interactions Tracking Router
Endpoints for logging and retrieving team-client interactions

#### `app.routers.crm_practices`

ZANTARA CRM - Practices Management Router
Endpoints for managing practices (KITAS, PT PMA, Visas, etc.)

#### `app.routers.crm_shared_memory`

ZANTARA CRM - Shared Memory Router
Team-wide memory access for AI and team members
Enables queries like "clients with upcoming renewals", "active practices for John Smith", etc.

#### `app.routers.handlers`

Handlers Registry Endpoint
Auto-discovers and exposes all available handlers/tools for ZANTARA

#### `app.routers.health`

ZANTARA RAG - Health Check Router

Provides health check endpoints for monitoring service status:
- /health - Basic health check for load balancers
- /health/detailed - Comprehensive service status for debugging

#### `app.routers.image_generation`

Image Generation Router - Handles image generation requests

#### `app.routers.ingest`

ZANTARA RAG - Ingestion Router
Book ingestion endpoints

#### `app.routers.instagram`

Instagram Business API Router
Handles webhook verification and incoming messages from Meta

#### `app.routers.intel`

Intel News API - Search and manage Bali intelligence news

#### `app.routers.legal_ingest`

Legal Document Ingestion Router
API endpoints for Indonesian legal document ingestion pipeline

#### `app.routers.memory_vector`

ZANTARA RAG - Memory Vector Router
Semantic memory storage and search using Qdrant
Complements Firestore-based memory system with vector search capabilities

#### `app.routers.notifications`

Multi-Channel Notification Router
REST API for ZANTARA notification system

#### `app.routers.oracle_ingest`

ORACLE INGEST API Router
Endpoint per caricare massivamente documenti legali su Qdrant

POST /api/oracle/ingest - Bulk upload di chunks con embeddings

#### `app.routers.oracle_universal`

=======================================
ZANTARA v5.3 (Ultra Hybrid) - Universal Oracle API
=======================================

Author: Senior DevOps Engineer & Database Administrator
Version: 5.3.0
Production Status: READY
Description:
Production-ready hybrid RAG system integrating:
- Qdrant Vector Database (Semantic Search)
- Google Drive Integration (PDF Document Repository)
- Google Gemini 2.5 Flash (Reasoning Engine)
- User Identity & Localization System (PostgreSQL)
- Multimodal Capabilities (Text + Audio)
- Comprehensive Error Handling & Logging

Language Protocol:
- Source Code & Logs: ENGLISH (Standard)
- Knowledge Base: Bahasa Indonesia (Indonesian Laws)
- WebApp UI: ENGLISH
- AI Responses: User's preferred language (from users.meta_json.language)

#### `app.routers.productivity`

Google Workspace Productivity Tools
Implements the 'Stellar Workspace' capabilities for ZANTARA

#### `app.routers.search`

ZANTARA RAG - Search Router
Semantic search with tier-based access control

#### `app.routers.team_activity`

Team Activity API Router
Endpoints for team timesheet and activity tracking

#### `app.routers.websocket`

WebSocket Router & Connection Manager
Handles real-time notifications via Redis Pub/Sub
Replaces Node.js websocket.ts

#### `app.routers.whatsapp`

WhatsApp Business API Router
Handles webhook verification and incoming messages from Meta

#### `app.services.api_key_auth`

API Key Authentication Service
Provides simple API key validation to bypass database dependency for testing

### Core

#### `core.__init__`

ZANTARA RAG - Core Components

#### `core.cache`

Redis Caching Layer for ZANTARA
Provides intelligent caching for expensive operations

Features:
- TTL-based expiration
- Automatic key generation
- Cache invalidation
- Hit/miss metrics

#### `core.chunker`

ZANTARA RAG - Text Chunking
Semantic text splitting for optimal RAG performance

#### `core.embeddings`

ZANTARA RAG - Embeddings Generation
Supports both OpenAI and Sentence Transformers

#### `core.legal.__init__`

Legal Document Processing Module
Specialized pipeline for Indonesian legal documents (UU, PP, Keppres, etc.)

#### `core.legal.chunker`

Legal Document Chunker - Stage 4: The Butcher
Pasal-aware semantic chunking with context injection

#### `core.legal.cleaner`

Legal Document Cleaner - Stage 1: The Washer
Removes non-content artifacts from Indonesian legal documents

#### `core.legal.constants`

Constants for Indonesian Legal Document Processing
Regex patterns, keywords, and structure markers

#### `core.legal.metadata_extractor`

Legal Metadata Extractor - Stage 2: The Librarian
Extracts structured metadata from Indonesian legal documents

#### `core.legal.structure_parser`

Legal Structure Parser - Stage 3: The Architect
Recognizes hierarchical structure of Indonesian legal documents

#### `core.parsers`

ZANTARA RAG - Document Parsers
Extract text from PDF and EPUB files

#### `core.plugins.__init__`

ZANTARA Unified Plugin Architecture

This module provides the core plugin system for ZANTARA, enabling:
- Standardized plugin interfaces
- Plugin discovery and registration
- Lifecycle management
- Performance monitoring
- Caching and rate limiting

#### `core.plugins.executor`

Plugin Executor

Executes plugins with performance monitoring, caching, rate limiting, and error handling.

#### `core.plugins.plugin`

Core Plugin Base Classes

Defines the base plugin interface that all ZANTARA plugins must implement.

#### `core.plugins.registry`

Plugin Registry

Central registry for all plugins. Handles loading, discovery, versioning, and lifecycle.

#### `core.qdrant_db`

ZANTARA RAG - Vector Database (Qdrant)
Qdrant client wrapper for embeddings storage and retrieval

### Data

#### `data.team_members`

ZANTARA Team Members Database

Importato dal JSON originale per uso programmatico

### Db

#### `db.__init__`

Database utilities and migrations

### Llm

#### `llm.__init__`

LLM clients for ZANTARA AI

#### `llm.zantara_ai_client`

ZANTARA AI Client - Primary engine for all conversational AI

AI Models Architecture:
- PRIMARY: Google Gemini 2.5 Flash (unlimited on ULTRA plan)

Configuration:
- GOOGLE_API_KEY: API key for Gemini (primary)

UPDATED 2025-11-30:
- Load rich system prompt from file
(zantara_v7_global_production.md)
- Structured context injection with XML tags
- Identity-aware prompting
- Reduced "Non ho documenti" aggressiveness

### Middleware

#### `middleware.error_monitoring`

Error Monitoring Middleware
Captures 4xx/5xx HTTP errors and sends alerts

#### `middleware.hybrid_auth`

Hybrid Authentication Middleware - Fail-Closed Implementation
Combines API Key and JWT authentication for flexible access control with security-first approach

#### `middleware.rate_limiter`

Rate Limiting Middleware for ZANTARA
Prevents API abuse and ensures fair usage

Features:
- IP-based rate limiting
- User-based rate limiting
- Configurable limits per endpoint
- Redis-backed for distributed systems

### Migrations

#### `migrations.001_fix_missing_tables`

Migration: Fix missing PostgreSQL tables
Date: 2025-10-19
Purpose: Create cultural_knowledge, query_clusters tables and fix memory_facts.id

#### `migrations.README_migrations`

Apply database migrations
Use this script when psql is not available locally
Migrations will be applied on Fly.io deployment

#### `migrations.apply_migration_007`

One-time script to apply migration 007 via Fly.io

#### `migrations.apply_migration_010`

One-time script to apply migration 010 via Fly.io or local
Migration: Fix team_members schema alignment

#### `migrations.apply_migration_012`

Apply Migration 012: Fix Production Schema Issues
Adds missing conversation_id column to interactions table

#### `migrations.migrate_crm_schema`

Apply CRM System Schema Migration
Connects to Fly.io PostgreSQL and applies migration 007

### Plugins

#### `plugins.__init__`

ZANTARA Plugins Directory

This directory contains all plugin implementations organized by category.

#### `plugins.bali_zero.__init__`

Bali Zero service plugins

#### `plugins.bali_zero.pricing_plugin`

Pricing Plugin - Official Bali Zero Pricing

Migrated from: backend/services/zantara_tools.py -> _get_pricing

#### `plugins.team.__init__`

Team management plugins

#### `plugins.team.list_members_plugin`

Team Members List Plugin

Migrated from: backend/services/zantara_tools.py -> _get_team_members_list

#### `plugins.team.search_member_plugin`

Team Member Search Plugin

Migrated from: backend/services/zantara_tools.py -> _search_team_member

### Prompts

#### `prompts.__init__`

Prompts package for Nuzantara AI - contains Jaksel personality and system prompts.

### Root

#### `__init__`

ZANTARA RAG Backend Package

#### `populate_inline`

Minimal Oracle population script - run in Fly.io shell

### Scripts

#### `scripts.check_deployment`

Deployment validation script for Reranker Optimization
Checks all components are ready before deployment

#### `scripts.fix_pdf_encoding`

Fix PDF Encoding - Extract clean UTF-8 text from PDFs

This script:
1. Finds all PDF files in kb/ directory
2. Extracts text using PyMuPDF (handles binary encoding issues)
3. Saves clean UTF-8 text as .txt files
4. Ready for re-ingestion into Qdrant

Usage:
    cd /path/to/backend
    source venv/bin/activate
    python scripts/fix_pdf_encoding.py

#### `scripts.ingest_laws`

Ingest Laws into Qdrant
-----------------------
Scans 'apps/scraper/data' for PDF and TXT files and ingests them using IngestionService.

#### `scripts.ingest_team_data`

Ingest Team Data into Qdrant
----------------------------
Reads team_members.json and upserts into 'bali_zero_team' collection.

### Self_Healing

#### `self_healing.backend_agent`

ðŸ¤– ZANTARA Backend Self-Healing Agent

Autonomous agent that monitors backend service health and auto-fixes issues
Runs continuously on each Fly.io service (RAG, Memory, etc.)

Features:
- Health checks (API, DB, Redis, Qdrant)
- Auto-restart on failures
- Memory leak detection
- Database connection pool management
- API endpoint monitoring
- Reports to Central Orchestrator

### Services

#### `services.__init__`

ZANTARA RAG - Services

#### `services.ai_crm_extractor`

ZANTARA CRM - AI Entity Extraction Service
Uses ZANTARA AI to extract structured data from conversations for CRM auto-population

#### `services.alert_service`

Alert Notification Service
Sends alerts for critical errors via Slack, Discord, and logging

#### `services.audit_service`

ZANTARA Audit Service
Handles security logging and system audit trails for compliance and debugging.
Replaces Node.js audit-trail.ts

#### `services.auto_crm_service`

ZANTARA CRM - Auto-Population Service
Automatically creates/updates clients and practices from chat conversations

#### `services.auto_ingestion_orchestrator`

Auto-Ingestion Orchestrator - Phase 5 (Automation Agent)

Automatically monitors external sources and updates Qdrant collections
with new regulations, laws, and business information.

Monitored Sources:
- OSS website (KBLI updates)
- Ditjen Imigrasi (visa regulations)
- DJP (tax circulars)
- BKPM newsletters
- Legal databases (for legal_updates)

Process:
1. Daily scrape of monitored sources
2. LLM filter: "Is this a regulation change?"
3. Extract key information
4. Generate embeddings
5. Add to relevant collection (tax_updates, legal_updates, etc.)
6. Notify admin of updates
7. Trigger collection health check

Integration with bali-intel-scraper:
- Extends existing scraper with structured ingestion
- Uses same 2-tier filtering (LLAMA â†’ ZANTARA AI)
- Adds to Qdrant instead of just logging
- LEGACY CODE CLEANED: Claude references removed

#### `services.autonomous_research_service`

Autonomous Research Agent - Phase 4 (Advanced Agent)

Self-directed research agent that iteratively explores Qdrant collections
to answer complex or ambiguous queries without human intervention.

Example: "How to open a crypto company in Indonesia?"
â†’ Iteration 1: Search kbli_eye â†’ "crypto" not in KBLI database
â†’ Iteration 2: Expand to legal_updates â†’ finds OJK crypto regulation 2024
â†’ Iteration 3: Search tax_genius â†’ crypto tax treatment
â†’ Iteration 4: Search visa_oracle â†’ fintech director visa requirements
â†’ Synthesis: Comprehensive answer despite no direct KBLI match

Key Features:
- Self-directed query expansion
- Iterative collection exploration
- Semantic similarity for expansion
- Reasoning chain transparency
- Automatic termination when sufficient info gathered

#### `services.calendar_service`

Google Calendar Service for ZANTARA
Handles event listing and scheduling using Google API.

#### `services.citation_service`

Citation Service - Add inline citations and source references to AI responses
Enhances credibility and transparency by showing where information comes from

This service enables AI to cite sources using inline references [1], [2] and
provide full source details at the end of responses, building user trust.

Author: ZANTARA Development Team
Date: 2025-10-16

#### `services.clarification_service`

Clarification Service - Detect ambiguous queries and request clarification
Improves response quality by ensuring the AI understands user intent clearly

This service detects when a user's question is ambiguous or incomplete,
prompting for clarification before generating a potentially incorrect response.

Author: ZANTARA Development Team
Date: 2025-10-16

#### `services.classification.__init__`

Classification Module
Intent classification and query type detection

#### `services.classification.intent_classifier`

Intent Classifier Module
Fast pattern-based intent classification without AI cost

#### `services.client_journey_orchestrator`

Client Journey Orchestrator - Phase 3 (Orchestration Agent #1)

Manages multi-step business workflows with automatic progress tracking,
document collection, and timeline management.

Example Journey: "PT PMA Setup"
â†’ Steps:
  1. Company name approval (KEMENKUMHAM) - Prerequisites: None
  2. Notary deed preparation - Prerequisites: Step 1 complete
  3. NIB application (OSS) - Prerequisites: Step 2 complete
  4. NPWP registration - Prerequisites: Step 3 complete
  5. Bank account opening - Prerequisites: Step 4 complete
  6. Virtual office setup - Prerequisites: Step 5 complete
  7. Director KITAS application - Prerequisites: Step 1-6 complete

Each step tracks:
- Status (pending/in_progress/completed/blocked)
- Required documents
- Estimated timeline
- Actual completion date
- Blocking issues

#### `services.collaborator_service`

Collaborator Service
--------------------

Loads real Bali Zero team data from JSON and provides search/list/stats helpers.
Replaces the legacy identity layers with a transparent, easy-to-edit dataset.

#### `services.collection_health_service`

Collection Health Monitor - Phase 3

Monitors the health and quality of all Qdrant collections:
- Last update timestamps
- Document counts
- Query hit rates
- Average confidence scores
- Staleness detection
- Actionable recommendations

Provides admin dashboard with collection health metrics.

#### `services.collective_memory_emitter`

Collective Memory Event Emitter
Emette eventi SSE per memoria collettiva al frontend

#### `services.collective_memory_workflow`

LangGraph Workflow for Collective Memory
Gestisce memoria collettiva intelligente (work + personal) con workflow condizionali

#### `services.context.__init__`

Context Module
Memory context building and RAG management

#### `services.context.context_builder`

Context Builder Module
Builds combined context from memory, RAG, team, cultural, and identity sources

UPDATED 2025-11-30:
- Added build_identity_context for self-recognition
- Added build_zantara_identity for AI self-awareness
- Enhanced combine_contexts with identity_context parameter
- Structured XML output for better context parsing

#### `services.context.rag_manager`

RAG Manager Module
Handles Qdrant search and result formatting

UPDATED 2025-11-30:
- Added identity query support (forces bali_zero_team collection)
- Added team query support
- Reduced aggressiveness of skip logic
- Better context formatting with sources

#### `services.context_window_manager`

Context Window Manager - Intelligent conversation history management
Prevents context overflow by keeping only recent messages with automatic summarization

#### `services.conversation_service`

ZANTARA Conversation Service - Conversation History Persistence

Manages conversation storage and retrieval with PostgreSQL.

#### `services.cross_oracle_synthesis_service`

Cross-Oracle Synthesis Agent - Phase 3 (Core Agent #1)

Orchestrates queries across multiple Oracle collections and synthesizes
integrated recommendations using ZANTARA AI.

Example Scenario: "I want to open a restaurant in Canggu"
â†’ Queries: kbli_eye, legal_architect, tax_genius, visa_oracle, property_knowledge, bali_zero_pricing
â†’ Synthesizes: Integrated plan with KBLI code, legal structure, tax obligations,
               staff visa requirements, location requirements, timeline, and total investment

This is the "magic" agent that makes complex business queries feel effortless.

#### `services.cultural_rag_service`

Cultural RAG Service - Retrieve ZANTARA-generated Indonesian cultural intelligence

This service retrieves cultural insights from Qdrant that were generated by ZANTARA AI
and injects them as context for ZANTARA AI to provide culturally-aware responses.

Pattern: ZANTARA AI generates cultural knowledge offline â†’ Qdrant stores â†’ ZANTARA AI uses at runtime
Cost: Zero (pre-generated, instant retrieval)
Latency: <5ms (Qdrant vector search)

#### `services.dynamic_pricing_service`

Dynamic Scenario Pricer - Phase 3 (Core Agent #2)

Calculates comprehensive pricing for business scenarios by aggregating
costs from multiple Oracle collections.

Example: "PT PMA Restaurant in Seminyak, 3 foreign directors"
â†’ Aggregates costs from:
  - KBLI setup (kbli_eye)
  - Legal incorporation (legal_architect)
  - Tax registration (tax_genius)
  - Visa costs (visa_oracle) x3
  - Location requirements (property_knowledge)
  - Service fees (bali_zero_pricing)

â†’ Output: Detailed breakdown + total investment + timeline

#### `services.emotional_attunement`

ZANTARA Emotional Attunement Service - Phase 4

Detects emotional state from message content and adapts response tone/style.
Integrates with CollaboratorService for personalized emotional preferences.

#### `services.followup_service`

Follow-up Service - Generate suggested follow-up questions
Helps users continue conversations naturally by suggesting relevant next questions

This service generates 3-4 contextually relevant follow-up questions after each AI response,
improving engagement and helping users discover what they can ask next.

Author: ZANTARA Development Team
Date: 2025-10-16

#### `services.gmail_service`

Gmail Service for ZANTARA
Handles email reading and sending using Google API.

#### `services.golden_answer_service`

Golden Answer Service - Fast lookup of pre-generated FAQ answers

Provides sub-100ms lookup of cached answers for frequent queries.
Integrated into Sonnet workflow BEFORE RAG search.

Flow:
1. User query comes in
2. Check golden_answers table (10-20ms PostgreSQL lookup)
3. If match found â†’ return cached answer immediately
4. If no match â†’ proceed to normal RAG + Sonnet generation

This provides 250x speedup for ~50-60% of queries.

#### `services.handler_proxy`

HANDLER PROXY SERVICE
Allows RAG backend to execute TypeScript handlers via HTTP

#### `services.health_monitor`

Health Monitor Service
Monitors system health and sends alerts on downtime or degradation

#### `services.image_generation_service`

Google Imagen Service for ZANTARA
Uses Google's Generative AI (Imagen) to generate images from text prompts.

#### `services.ingestion_service`

ZANTARA RAG - Ingestion Service
Book processing pipeline: parse â†’ chunk â†’ embed â†’ store
Auto-routes legal documents to LegalIngestionService

#### `services.intelligent_router`

Intelligent Router - ZANTARA AI (REFACTORED 2025)
Uses Gemini 2.5 Flash with In-Context Learning for Jaksel Persona.

UPDATED 2025-12-04:
- Replaced SimpleJakselCaller with GeminiJakselService
- Removed legacy post-processing
- Integrated direct RAG context injection
- Optimized streaming

#### `services.knowledge_graph_builder`

Knowledge Graph Builder - Phase 4 (Advanced Agent)

Builds and maintains a knowledge graph of relationships between entities
discovered in Qdrant collections.

Example Knowledge Graph:
```
KBLI 56101 (Restaurant)
  â”œâ”€â†’ requires â†’ NIB
  â”œâ”€â†’ requires â†’ NPWP
  â”œâ”€â†’ tax_obligation â†’ PPh 23 (2%)
  â”œâ”€â†’ tax_obligation â†’ PPn (11%)
  â”œâ”€â†’ legal_structure â†’ PT vs CV
  â”œâ”€â†’ location_restriction â†’ Zoning rules
  â””â”€â†’ staff_visa â†’ IMTA requirements

PT PMA
  â”œâ”€â†’ requires â†’ Min Investment (Rp 10B)
  â”œâ”€â†’ requires â†’ Foreign Director (min 1)
  â”œâ”€â†’ process_time â†’ 60-90 days
  â”œâ”€â†’ registration_at â†’ BKPM
  â””â”€â†’ related_to â†’ KBLI codes

KITAS (Limited Stay Permit)
  â”œâ”€â†’ requires â†’ Sponsor Company
  â”œâ”€â†’ requires â†’ IMTA
  â”œâ”€â†’ validity â†’ 1 year (renewable)
  â”œâ”€â†’ cost â†’ Rp 5-15 million
  â””â”€â†’ related_to â†’ Work Permit
```

The graph is stored in JSON/dict format (could be migrated to Neo4j later).

#### `services.legal_ingestion_service`

Legal Ingestion Service
Specialized ingestion pipeline for Indonesian legal documents

#### `services.memory_fact_extractor`

Memory Fact Extractor - Automatic key facts extraction from conversations
Extracts important facts to save in user memory for context building

#### `services.memory_service_postgres`

ZANTARA Memory Service - PostgreSQL Backend (Fly.io)

Manages user memory (profile facts, conversation summary, counters) with PostgreSQL persistence.
Replaces Firestore with PostgreSQL for Fly.io deployment.

#### `services.notification_hub`

Multi-Channel Notification Hub for ZANTARA
Unified notification system across email, WhatsApp, SMS, and in-app

Features:
- Email (SendGrid/SMTP)
- WhatsApp Business (Twilio)
- SMS (Twilio)
- In-app notifications
- Slack (team notifications)
- Template management
- Delivery tracking
- Retry logic

#### `services.performance_optimizer`

Performance Optimization Enhancements
For ZANTARA RAG Backend Python

#### `services.personality_service`

ZANTARA Multi-Personality Service

Gestisce le diverse personalitÃ  dell'AI system:
- Jaksel: Indonesian slang (Amanda, Anton, Krisna, Dea, etc.)
- ZERO: Italian style (Zero, Nina)
- Professional: Standard English/Indonesian
- Custom: Basato sulle preferenze del team member

Integra Gemini 2.5 (RAG research) + Zantara Oracle Cloud (personality voice)

#### `services.pricing_service`

Bali Zero Official Pricing Service
Loads official prices from JSON (NO AI GENERATION)

#### `services.proactive_compliance_monitor`

Proactive Compliance Monitor - Phase 3 (Orchestration Agent #2)

Monitors compliance deadlines and requirements for clients, sending
proactive alerts before deadlines.

Features:
- Tracks visa expiry dates (KITAS, KITAP, passport)
- Monitors tax filing deadlines (SPT Tahunan, PPh, PPn)
- Tracks license renewals (IMTA, NIB, business permits)
- Monitors regulatory changes from legal_updates/tax_updates
- Sends proactive notifications (60/30/7 days before)
- Auto-calculates renewal costs from bali_zero_pricing

Example Monitored Items:
- KITAS expiry: Remind 60 days before
- SPT Tahunan deadline (March 31): Remind in February
- IMTA renewal: Remind 30 days before
- Regulation changes: Immediate alert if affects client

#### `services.query_router`

ZANTARA RAG - Query Router
Intelligent routing between multiple Qdrant collections based on query content

Phase 3 Enhancement: Smart Fallback Chain Agent
- Confidence scoring for routing decisions
- Automatic fallback to secondary collections when confidence is low
- Configurable fallback chains per domain
- Detailed logging and metrics

#### `services.reranker_audit`

Reranker Audit Trail Service
Records all critical reranker operations for compliance and debugging

Features:
- GDPR-compliant logging (no PII in logs)
- Performance metrics tracking
- Error tracking
- Rate limit violation logging
- Security event logging

#### `services.reranker_service`

Re-ranker Service for improved retrieval quality
Uses Cross-Encoder to re-rank Qdrant results by semantic relevance

OPTIMIZATIONS:
- Query similarity caching (cache reranker results for similar queries)
- Batch reranking for multi-query scenarios
- Performance monitoring (latency, accuracy metrics)
- Target: +40% relevance, <50ms rerank time

#### `services.routing.__init__`

Routing Module
Specialized service routing and response handling

#### `services.routing.response_handler`

Response Handler Module
Applies response sanitization and quality enforcement

#### `services.routing.specialized_service_router`

Specialized Service Router Module
Routes to autonomous research and cross-oracle synthesis services

#### `services.search_service`

ZANTARA RAG - Search Service
RAG search logic with tier-based access control and multi-collection routing

Phase 3 Enhancement: Conflict Resolution Agent
- Multi-collection search with fallback chains
- Automatic conflict detection between collections
- Timestamp-based conflict resolution
- Transparent conflict reporting

#### `services.semantic_cache`

Semantic Cache Service for RAG System

Features:
- Cache query embeddings (avoid re-computing)
- Cache RAG search results
- Similarity-based cache lookup (cosine similarity)
- TTL-based expiration
- LRU eviction policy

Performance Impact:
- Latency: 800ms â†’ 150ms (-81%)
- API costs: -50% (fewer embeddings)
- Database load: -70% (fewer Qdrant queries)

#### `services.session_service`

Session Service - Redis-based conversation history storage for ZANTARA

Eliminates URL length constraints by storing conversation history in Redis
and passing only session_id in requests. Supports 50+ message conversations.

Author: ZANTARA AI Code (Bali Zero Team)  # LEGACY CODE CLEANED: was Claude
Date: November 5, 2025

#### `services.smart_oracle`

Zantara Smart Oracle - Enhanced PDF Analysis with Google Drive Integration

This module provides intelligent document analysis by:
1. Downloading PDFs from Google Drive using Service Account
2. Processing documents with Google Gemini AI
3. Providing accurate answers based on full document content

#### `services.streaming_service`

Streaming Service - Real-time token-by-token streaming
Implements Server-Sent Events (SSE) for AI responses

This service enables token-by-token streaming of AI responses, dramatically
improving perceived responsiveness (70-80% faster perceived response time).

Author: ZANTARA Development Team
Date: 2025-10-16

#### `services.team_analytics_service`

Team Work Analytics Service
7 Advanced Techniques for Team Performance Analysis

Provides intelligent insights on:
1. Pattern Recognition - Work hour patterns and habits
2. Productivity Scoring - Session productivity metrics
3. Burnout Detection - Early warning signs
4. Performance Trends - Long-term performance analysis
5. Workload Balance - Team workload distribution
6. Optimal Hours - Best performance time windows
7. Team Insights - Collaboration and synergy analysis

#### `services.team_timesheet_service`

Team Timesheet Service
Manages team member work hours tracking (clock-in/clock-out)
Timezone: Asia/Makassar (Bali Time, UTC+8)

#### `services.tool_executor`

TOOL EXECUTOR SERVICE
Handles ZANTARA AI tool use execution via handler proxy
Supports both TypeScript handlers (HTTP) and Python ZantaraTools (direct)
LEGACY CODE CLEANED: Anthropic references removed - using ZANTARA AI only

#### `services.tools.__init__`

Tools Module
Tool loading, caching, and detection

#### `services.vertex_ai_service`

Vertex AI Service
Handles interactions with Google Cloud Vertex AI (Gemini Pro).
Used as a fallback for complex extraction tasks.

#### `services.work_session_service`

Work Session Tracking Service
Tracks team member work hours and activities
All reports sent to ZERO only

#### `services.zantara_tools`

ZANTARA Tools - Python Native Tools for ZANTARA AI
Direct execution (no HTTP calls) - faster & more reliable
LEGACY CODE CLEANED: Claude references removed - using ZANTARA AI only

### Utils

#### `utils.__init__`

ZANTARA RAG - Utilities

#### `utils.response_sanitizer`

Response Sanitization Utilities for ZANTARA
Fixes Phase 1 & 2: Remove training data artifacts and enforce quality standards

#### `utils.tier_classifier`

ZANTARA RAG - Tier Classification
Classify books into knowledge tiers (S, A, B, C, D)

## Services

### `AlertService`

**Module:** `services.alert_service`

Service for sending alerts to various channels

### `AuditService`

**Module:** `services.audit_service`

Service for logging security and system events to the database.

### `AutoCRMService`

**Module:** `services.auto_crm_service`

Automatically populate CRM from conversations using AI extraction

### `AutonomousResearchService`

**Module:** `services.autonomous_research_service`

Autonomous research agent that explores Qdrant collections iteratively.

The agent:
1. Starts with initial query
2. Searches most relevant collection
3. Analyzes results for gaps
4. Expands query based on findings
5. Searches additional collections
6. Repeats until confident or max iterations
7. Synthesizes findings into final answer using ZANTARA AI

### `CacheService`

**Module:** `core.cache`

Intelligent caching service with Redis backend
Falls back to in-memory cache if Redis unavailable

### `CalendarService`

**Module:** `services.calendar_service`

Service to interact with Google Calendar API.

### `CitationService`

**Module:** `services.citation_service`

Manages citation formatting and source references for AI responses

Features:
- Inline citation markers [1], [2], etc.
- Full source details with titles, URLs, dates
- Automatic citation numbering
- Support for multiple source types (RAG docs, memory, web)

### `ClarificationService`

**Module:** `services.clarification_service`

Detects ambiguous queries and generates clarification requests

Features:
- Pattern-based ambiguity detection
- Context-aware clarification questions
- Multi-language support (EN, IT, ID)
- Confidence scoring for ambiguity detection

### `CollaboratorService`

**Module:** `services.collaborator_service`

Load collaborator profiles from JSON and expose search utilities.

Compatible with the old API (TEAM_DATABASE, identify) so existing plugins/tools
continue to work.

### `CollectionHealthService`

**Module:** `services.collection_health_service`

Monitors and reports on Qdrant collection health.

Tracks:
- Collection usage patterns
- Data freshness
- Query performance
- Quality metrics

Provides:
- Health scores per collection
- Staleness alerts
- Actionable recommendations
- Admin dashboard data

### `ConversationService`

**Module:** `services.conversation_service`

Service for managing conversation history.

Features:
- Save conversations to PostgreSQL
- Retrieve recent conversations
- Metadata tracking (collaborator, timestamp, token usage)

### `CrossOracleSynthesisService`

**Module:** `services.cross_oracle_synthesis_service`

Orchestrates multi-Oracle queries and synthesizes integrated responses.

The "conductor" of the Oracle system - knows when to consult which Oracles
and how to combine their knowledge into actionable business plans.

### `CulturalRAGService`

**Module:** `services.cultural_rag_service`

Retrieves ZANTARA-generated Indonesian cultural intelligence for ZANTARA AI enrichment

### `DynamicPricingService`

**Module:** `services.dynamic_pricing_service`

Calculates scenario-based pricing by aggregating Oracle knowledge.

Works with CrossOracleSynthesisService to extract cost information.

### `EmotionalAttunementService`

**Module:** `services.emotional_attunement`

Analyzes message content to detect emotional state and suggest appropriate tone.

Features:
- Pattern-based emotion detection
- Keyword analysis
- Punctuation and capitalization analysis
- Integration with collaborator preferences
- Tone adaptation suggestions

### `FollowupService`

**Module:** `services.followup_service`

Generates suggested follow-up questions based on conversation context

Features:
- Context-aware question generation
- Language-appropriate suggestions (EN, IT, ID)
- Topic-specific follow-ups (business, casual, technical)
- Fast generation using ZANTARA AI

### `GmailService`

**Module:** `services.gmail_service`

Service to interact with Gmail API.

### `GoldenAnswerService`

**Module:** `services.golden_answer_service`

Fast lookup and retrieval of pre-generated golden answers

### `GoogleServices`

**Module:** `app.routers.oracle_universal`

Google Cloud services manager

### `HandlerProxyService`

**Module:** `services.handler_proxy`

Service to execute TypeScript backend handlers from Python RAG backend

### `IdentityService`

**Module:** `app.modules.identity.service`

Identity Service - Authentication and user management

Replicates the exact login flow from Node.js backend (team-login.ts)

### `ImageGenerationService`

**Module:** `services.image_generation_service`

Service to generate images using Google's Generative AI.

### `IngestionService`

**Module:** `services.ingestion_service`

Complete book ingestion pipeline.
Handles the full flow from raw document to searchable embeddings.

### `KnowledgeService`

**Module:** `app.modules.knowledge.service`

Knowledge Service - RAG search with access control and multi-collection support

This service encapsulates all RAG/search logic, separated from HTTP interface.

### `LegalIngestionService`

**Module:** `services.legal_ingestion_service`

Specialized ingestion service for Indonesian legal documents.
Implements 4-stage pipeline: Clean â†’ Extract Metadata â†’ Parse Structure â†’ Chunk

### `MemoryServicePostgres`

**Module:** `services.memory_service_postgres`

Service for managing persistent user memory with PostgreSQL.

Features:
- Profile facts (max 10, auto-deduplicated)
- Conversation summary (max 500 chars)
- Activity counters
- PostgreSQL persistence with in-memory fallback

### `OptimizedSearchService`

**Module:** `services.performance_optimizer`

Performance-optimized search service

### `PersonalityService`

**Module:** `services.personality_service`

Servizio che gestisce le diverse personalitÃ  di ZANTARA
basandosi sul team member che interagisce

### `PoliticsIngestionService`

**Module:** `services.politics_ingestion`

Ingest structured Indonesian politics KB (1999â†’today) into Qdrant.
Stores in collection 'politics_id'.

### `PricingService`

**Module:** `services.pricing_service`

Official Bali Zero pricing - NO AI GENERATION ALLOWED

### `RerankerAuditService`

**Module:** `services.reranker_audit`

Audit trail service for reranker operations

Records:
- All reranker calls (query hash, latency, cache hits/misses)
- Performance metrics
- Error events
- Rate limit violations
- Security events

### `RerankerService`

**Module:** `services.reranker_service`

Cross-Encoder re-ranker for semantic search results

Improves retrieval quality by:
1. Over-fetching candidates from Qdrant (n=20)
2. Re-ranking by TRUE semantic relevance (not just vector distance)
3. Returning top-K results (n=5)

Performance:
- Model: ms-marco-MiniLM-L-6-v2 (400MB RAM)
- Latency: ~30ms for 20 documents
- Quality boost: +40% precision@5

### `SearchService`

**Module:** `services.search_service`

RAG search with access control and multi-collection support

### `ServiceHealth`

**Module:** `app.core.service_health`

Health information for a single service.

### `ServiceRegistry`

**Module:** `app.core.service_health`

Registry for tracking service health status.

Provides:
- Service registration with health status
- Overall system health assessment
- Critical service failure detection
- Health reporting for monitoring endpoints

### `ServiceStatus`

**Module:** `app.core.service_health`

Service health status levels.

### `SessionService`

**Module:** `services.session_service`

Manages conversation sessions in Redis for extended context support.

Features:
- Create/Read/Update/Delete sessions
- 24-hour TTL with auto-extension on activity
- JSON serialization of conversation history
- Automatic cleanup of expired sessions

### `SpecializedServiceRouter`

**Module:** `services.routing.specialized_service_router`

Router for specialized services

Routes complex queries to:
- AutonomousResearchService: Ambiguous/complex multi-collection queries
- CrossOracleSynthesisService: Business planning and comprehensive queries
- ClientJourneyOrchestrator: Multi-step business workflows

### `StreamingService`

**Module:** `services.streaming_service`

Handles real-time streaming of AI responses using SSE

Features:
- Token-by-token streaming from ZANTARA AI
- Metadata collection (model, usage stats)
- Error handling for network failures
- Support for multiple ZANTARA AI models

### `TeamAnalyticsService`

**Module:** `services.team_analytics_service`

Advanced analytics for team work sessions
Provides 7 intelligent analysis techniques

### `TeamTimesheetService`

**Module:** `services.team_timesheet_service`

Team work hours tracking service

Features:
- Clock in/out tracking
- Auto-logout at 18:30 Bali time
- Daily/weekly/monthly summaries
- Real-time online status
- Admin-only dashboard data

### `VertexAIService`

**Module:** `services.vertex_ai_service`

Service for interacting with Vertex AI Gemini models.

### `WorkSessionService`

**Module:** `services.work_session_service`

Track team work sessions and send reports to ZERO
ZERO decides what to share with team

Data persistence:
- PostgreSQL: Primary storage (Fly.io cloud database)
- JSONL file: Local backup log (work_sessions_log.jsonl)

## Agents

### `app/routers/agents.py`

ZANTARA Agentic Functions Router
Exposes all 10 advanced agentic capabilities as REST API endpoints

Phase 1-2: Foundation Agents (6)
Phase 3: Orchestration Agents (2)
Phase 4: Advanced Intelligence (1)
Phase 5: Automation (1)

Performance Optimizations:
- Redis caching (5 min TTL for status endpoints)
- Rate limiting (prevents abuse)
- Request deduplication

SECURITY: All endpoints require authentication (added 2025-12-03)

### `app/routers/autonomous_agents.py`

TIER 1 AUTONOMOUS AGENTS - HTTP Endpoints
Provides HTTP API for orchestrator to trigger autonomous agents

Agents:
1. Conversation Quality Trainer
2. Client LTV Predictor & Nurturing
3. Knowledge Graph Builder

### `self_healing/backend_agent.py`

ðŸ¤– ZANTARA Backend Self-Healing Agent

Autonomous agent that monitors backend service health and auto-fixes issues
Runs continuously on each Fly.io service (RAG, Memory, etc.)

Features:
- Health checks (API, DB, Redis, Qdrant)
- Auto-restart on failures
- Memory leak detection
- Database connection pool management
- API endpoint monitoring
- Reports to Central Orchestrator

---

*Last updated: 2025-12-05 01:26:59*