<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZANTARA - Test 30 Domande Business</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .controls {
            padding: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .progress-container {
            padding: 0 30px 30px 30px;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .questions-container {
            padding: 0 30px 30px 30px;
            max-height: 600px;
            overflow-y: auto;
        }

        .question-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .question-item.active {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .question-item.success {
            border-color: #28a745;
            background: #f0fff4;
        }

        .question-item.error {
            border-color: #dc3545;
            background: #fff5f5;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .question-number {
            font-weight: bold;
            color: #667eea;
        }

        .question-category {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .cat-immigration {
            background: #e3f2fd;
            color: #1976d2;
        }

        .cat-business {
            background: #fff3e0;
            color: #e65100;
        }

        .cat-tax {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .question-text {
            color: #495057;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .response-container {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }

        .response-container.visible {
            display: block;
        }

        .response-header {
            font-weight: 600;
            color: #495057;
            margin-bottom: 10px;
        }

        .response-text {
            color: #6c757d;
            line-height: 1.5;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .status-icon {
            font-size: 1.2rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß™ ZANTARA Business Test</h1>
            <p>30 Domande Alta Difficolt√† - Immigration, Business & Tax</p>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="total">30</div>
                <div class="stat-label">Totale Domande</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completed">0</div>
                <div class="stat-label">Completate</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="successes">0</div>
                <div class="stat-label">Successi</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avgTime">-</div>
                <div class="stat-label">Tempo Medio</div>
            </div>
        </div>

        <div class="controls">
            <button class="btn btn-primary" id="startBtn" onclick="startTest()">
                ‚ñ∂Ô∏è Inizia Test
            </button>
            <button class="btn btn-secondary" id="pauseBtn" onclick="pauseTest()" disabled>
                ‚è∏Ô∏è Pausa
            </button>
            <button class="btn btn-success" id="exportBtn" onclick="exportResults()" disabled>
                üíæ Esporta Risultati
            </button>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%">
                    0%
                </div>
            </div>
        </div>

        <div class="questions-container" id="questionsContainer"></div>
    </div>

    <script>
        // API Configuration
        const API_URL = 'https://nuzantara-rag.fly.dev/bali-zero/chat';
        const TEST_EMAIL = 'test-business@zantara.com';

        // Test questions
        const questions = [
            // IMMIGRATION (10)
            { id: 1, category: 'immigration', text: 'Sono un imprenditore italiano con PT PMA attiva (80% foreign ownership, KBLI 62010) e 3 dipendenti indonesiani. Voglio portare mia moglie e mio figlio di 15 anni. Qual √® il percorso KITAS pi√π veloce per loro? Devo fare E31 o posso fare E23? Quali documenti servono per il figlio minorenne e quanto tempo ci vuole?' },
            { id: 2, category: 'immigration', text: 'Ho KITAS E33G (Remote Worker) valida per 2 anni. Voglio aprire PT PMA per fare consulting. Devo cancellare E33G e rifare tutto da zero con E28A, oppure posso convertire? Se cancello E33G, perdo il visto e devo uscire dall\'Indonesia? Quali sono i rischi e i tempi?' },
            { id: 3, category: 'immigration', text: 'Mia PT PMA √® stata approvata da BKPM con capitale 10 miliardi IDR. Ho 4 azionisti stranieri (USA, Italia, Singapore, Australia) tutti al 20%. Chi di loro pu√≤ ottenere KITAS E28A Investor? Serve davvero 10 miliardi per 4 persone o bastano 2.5 miliardi? E se uno degli azionisti √® solo passive investor?' },
            { id: 4, category: 'immigration', text: 'Ho appena fatto IMTA approval per 2 expat (Director e CTO). KITAS E23 Working sono in processing. Il mio lawyer dice che ci vogliono 45 giorni, ma ho letto che con fast track si fa in 14 giorni. Quanto costa il fast track? √à legale? Chi lo gestisce? E se qualcosa va storto con IMTA, cosa succede al KITAS?' },
            { id: 5, category: 'immigration', text: 'Sto per sposare una ragazza indonesiana. Ho B211A visa (visit). Dopo matrimonio posso fare subito E31 Limited Stay KITAS sposato con indonesiana? Oppure devo uscire e rientrare? Quanti documenti servono? L\'apostille del certificato di celibato italiano √® riconosciuto? Posso lavorare con E31 o serve aggiungere IMTA?' },
            { id: 6, category: 'immigration', text: 'La mia PT PMA ha cambiato sede legale da Jakarta a Bali, e abbiamo fatto domicile letter update. I miei 2 expat con KITAS E23 Working devono rifare il KITAS per Bali o basta notificare immigration? C\'√® un costo? E se uno di loro lavora da remoto da Bali ma il contratto dice Jakarta, √® legale?' },
            { id: 7, category: 'immigration', text: 'Ho Golden Visa / Second Home Visa valida 10 anni (deposit 2 billion IDR). Posso aprire PT PMA e lavorare nella mia azienda? Oppure Golden Visa √® solo per investment e non posso essere Director? Se non posso lavorare, posso almeno fare shareholder meeting e firmare documenti aziendali?' },
            { id: 8, category: 'immigration', text: 'Mio KITAS E28A Investor sta per scadere tra 30 giorni. La mia PT PMA ha avuto perdite per 2 anni consecutivi e il revenue √® sotto 500 milioni IDR. Immigration rinnover√† il KITAS oppure mi chiedono proof of investment activity? Cosa succede se rigettano il renewal? Ho diritto a exit permit?' },
            { id: 9, category: 'immigration', text: 'Ho fatto D12 business explorer visa multiple entry per 1 anno. Ogni ingresso posso stare 60 giorni. Dopo 4 viaggi consecutivi (4x60 giorni), immigration Bali mi ha detto che devo stare fuori almeno 30 giorni. √à vero? Qual √® la legge precisa? Quante volte posso entrare in 1 anno con D12?' },
            { id: 10, category: 'immigration', text: 'Sono cittadino USA con KITAS E33G Remote Worker. Lavoro per azienda americana (W2 employee), ma faccio anche freelance consulting per clienti indonesiani (fatturati tramite azienda USA). Immigration ha fatto controllo random e mi ha chiesto spiegazioni. Rischio cancellazione KITAS? Devo fare E23 Working invece? Quali sono le conseguenze?' },

            // BUSINESS (10)
            { id: 11, category: 'business', text: 'Voglio aprire PT PMA per software development (KBLI 62010) con 2 soci: io italiano 70%, partner indonesiano 30%. Capitale 10 miliardi IDR. Il partner indonesiano vuole mettere asset (tanah certificato SHM Bali del valore di 8 miliardi) invece di cash. BKPM accetta asset contribution? Serve perizia indipendente? Quali tasse sulla valutazione dell\'asset?' },
            { id: 12, category: 'business', text: 'La mia PT PMA (100% foreign owned) ha fatto revenue 5 miliardi IDR nel 2024, ma net profit negativo (loss 500 milioni) a causa di marketing spend alto. Per il 2025, BKPM ha mandato warning letter dicendo che devo raggiungere minimum investment realization. Cosa significa? Rischio chiusura forzata? Come si calcola minimum investment realization?' },
            { id: 13, category: 'business', text: 'Ho PT PMA (NIB OSS, KBLI 47911 e-commerce). Voglio aggiungere KBLI 56101 (restaurant) per aprire un ristorante fisico a Canggu. Devo fare company revision (anggaran dasar amendment) oppure posso solo aggiungere KBLI sul OSS? Il restaurant √® DNI (forbidden for foreign investment), come faccio? Serve nominee indonesiano?' },
            { id: 14, category: 'business', text: 'Mia PT PMA ha 3 shareholders esteri (40%, 35%, 25%). Uno shareholder al 25% vuole uscire e vendere le sue shares a me. Serve notarial deed per share transfer? Qual √® la tassa? Devo fare BKPM notification? E se invece voglio diluire uno shareholder da 25% a 10% facendo capital increase, come funziona?' },
            { id: 15, category: 'business', text: 'Ho PT PMA con sede legale a Jakarta (domicile letter di propriet√†). Voglio spostare sede operativa a Bali, ma mantenere sede legale a Jakarta. Serve fare domicile letter update a Bali? Posso avere 2 domicile letters (Jakarta legal, Bali operational)? Quali implicazioni fiscali (PPN, tax office registration)?' },
            { id: 16, category: 'business', text: 'La mia PT PMA (62010 software) ha contratto con cliente in Singapura (payment in USD). Cliente paga su bank account Singapore mio personale perch√© la PT non ha ancora swift code. Posso fare invoice dalla PT per questo payment? Quali rischi fiscali? Devo dichiarare questo income come foreign exchange in annual tax report?' },
            { id: 17, category: 'business', text: 'Voglio aprire PT PMA 100% foreign owned per alcohol import & distribution a Bali (KBLI 46342). Serve license SKPL (Surat Keterangan Pendaftaran Legalitas) + alcohol import permit dal Ministry of Trade. Quali sono i requisiti minimi? Quanto costa? Serve warehouse dedicato? Tempo di approval?' },
            { id: 18, category: 'business', text: 'Mia PT PMA (consulting) ha 1 director straniero (me). Voglio aggiungere un secondo director indonesiano (local partner) per facilitare banking e government interaction. Devo fare deed of amendment? Board resolution √® sufficiente? Questo director indonesiano deve essere shareholder o pu√≤ essere solo employee con director title?' },
            { id: 19, category: 'business', text: 'Ho PT PMA (KBLI 58130 newspaper publishing). Google Adsense ha bloccato il mio account perch√© dice che Indonesia richiede local media license. Serve surat izin usaha penerbitan pers dal Ministry of Communication? Questo √® included nel NIB OSS oppure √® separate license? Quanto tempo ci vuole?' },
            { id: 20, category: 'business', text: 'La mia PT PMA ha chiuso operazioni e voglio fare voluntary liquidation. Ho ancora 1 expat con KITAS E23 Working legato alla PT. Devo cancellare il KITAS prima di liquidare la PT? Qual √® il processo corretto? Quanto tempo ci vuole? Posso fare liquidation mentre ho ancora employees e tax obligations pending?' },

            // TAX (10)
            { id: 21, category: 'tax', text: 'Sono tax resident in Italia, ma passo 6 mesi/anno a Bali con KITAS E28A Investor. Indonesia dice che dopo 183 giorni divento tax resident indonesiano. Italia dice che resto tax resident italiano finch√© mantengo casa e famiglia in Italia. C\'√® tax treaty Italia-Indonesia? Rischio double taxation? Come dichiaro worldwide income?' },
            { id: 22, category: 'tax', text: 'Mia PT PMA fattura 10 miliardi IDR/anno. Ho 3 expat con KITAS che guadagnano 15,000 USD/mese ciascuno (paid by PT PMA). Devo fare PPh 21 (income tax withholding) su stipendio expat? Qual √® la progressive tax rate per income sopra 500 milioni IDR/anno? Posso dedurre housing allowance e flight tickets?' },
            { id: 23, category: 'tax', text: 'Ho PT PMA (e-commerce) che vende prodotti digitali (corsi online) a clienti indonesiani. Devo pagare PPN (VAT) 11%? Oppure prodotti digitali sono esenti? Se devo pagare PPN, serve PKP (taxable enterprise) registration dal tax office? Quali sono penalties se non sono PKP e ho venduto senza PPN per 2 anni?' },
            { id: 24, category: 'tax', text: 'Mia PT PMA paga dividendi ai 2 shareholders stranieri (totale 500 milioni IDR). Devo fare PPh 26 (withholding tax on dividends) del 20%? Oppure con tax treaty si riduce? Se shareholders sono in Singapore (tax treaty), qual √® la rate? Devo fare tax reporting entro quando?' },
            { id: 25, category: 'tax', text: 'Ho PT PMA che compra software licenses dalla azienda madre in USA (total 200 milioni IDR/anno). Questo √® considerato royalty payment? Devo fare PPh 26 (withholding tax) 20% su royalty? Serve tax clearance dal tax office prima del wire transfer? Come si calcola taxable base per software licensing?' },
            { id: 26, category: 'tax', text: 'Mia PT PMA ha perso 1 miliardo IDR nel 2023 e 500 milioni nel 2024. Nel 2025 prevedo profit 2 miliardi. Posso fare loss carry-forward per offset taxes 2025? Per quanti anni si pu√≤ portare avanti le losses? Serve documentazione speciale per tax office? Quali rischi se tax office rigetta il carry-forward?' },
            { id: 27, category: 'tax', text: 'Ho KITAS E33G Remote Worker. Lavoro per azienda USA che mi paga su bank account italiano. Non ho income indonesiano. Devo fare tax filing in Indonesia? Devo prendere NPWP? Se tax office scopre che non ho mai fatto filing, quali penalties? Posso richiedere tax residency certificate dall\'Italia per evitare Indonesia tax?' },
            { id: 28, category: 'tax', text: 'Mia PT PMA ha fatto import di equipment dal China (valore CIF 500 milioni IDR). Customs ha applicato import duty 10% + PPN 11% + PPh 22 (prepaid income tax) 2.5%. Posso deduct PPh 22 dal corporate income tax annuale? Come si fa il claim? Serve documentazione speciale? Tempo limite per claim?' },
            { id: 29, category: 'tax', text: 'Ho PT PMA con revenue 15 miliardi IDR/anno. Tax office ha fatto audit e trovato discrepancies per 200 milioni (invoice senza PPN). Mi hanno dato assessment letter con penalty 50% + interest. Posso fare objection (keberatan)? Qual √® il processo? Devo pagare prima l\'assessment e poi fare objection, oppure posso bloccare il payment durante objection?' },
            { id: 30, category: 'tax', text: 'Sono freelance con NPWP. Lavoro da remoto per clienti internazionali (revenue 500 milioni IDR/anno). Non ho PT, lavoro come orang pribadi (individual). Devo fare PPh 25 (monthly installment) o solo annual tax filing PPh 29? Posso deduct business expenses (laptop, coworking) senza PT? Quali rischi se non ho made monthly payments?' }
        ];

        // Test state
        let currentIndex = 0;
        let results = [];
        let isPaused = false;
        let isRunning = false;
        let totalTime = 0;

        // Initialize UI
        function init() {
            const container = document.getElementById('questionsContainer');
            questions.forEach(q => {
                const div = document.createElement('div');
                div.className = `question-item cat-${q.category}`;
                div.id = `question-${q.id}`;
                div.innerHTML = `
                    <div class="question-header">
                        <span class="question-number">Domanda ${q.id}/30</span>
                        <span class="question-category cat-${q.category}">${q.category.toUpperCase()}</span>
                    </div>
                    <div class="question-text">${q.text}</div>
                    <div class="response-container" id="response-${q.id}">
                        <div class="response-header">Risposta ZANTARA:</div>
                        <div class="response-text" id="response-text-${q.id}"></div>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // Start test
        async function startTest() {
            if (isRunning) return;

            isRunning = true;
            isPaused = false;
            currentIndex = 0;
            results = [];
            totalTime = 0;

            document.getElementById('startBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = false;

            await runQuestions();
        }

        // Run questions sequentially
        async function runQuestions() {
            while (currentIndex < questions.length && !isPaused) {
                const q = questions[currentIndex];
                await askQuestion(q);
                currentIndex++;

                if (currentIndex < questions.length && !isPaused) {
                    await sleep(2000); // 2 second pause between questions
                }
            }

            if (currentIndex >= questions.length) {
                finishTest();
            }
        }

        // Ask single question
        async function askQuestion(q) {
            const questionEl = document.getElementById(`question-${q.id}`);
            const responseEl = document.getElementById(`response-${q.id}`);
            const responseTextEl = document.getElementById(`response-text-${q.id}`);

            questionEl.classList.add('active');
            responseTextEl.innerHTML = '<div class="spinner"></div> Pensando...';
            responseEl.classList.add('visible');

            const startTime = Date.now();

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        query: q.text,
                        user_email: TEST_EMAIL,
                        user_role: 'member',
                        tools: [],
                        tool_choice: { type: 'auto' }
                    })
                });

                const endTime = Date.now();
                const duration = endTime - startTime;
                totalTime += duration;

                const data = await response.json();

                questionEl.classList.remove('active');

                if (data.success && data.response) {
                    questionEl.classList.add('success');
                    responseTextEl.innerHTML = `
                        <span class="status-icon">‚úÖ</span> ${data.response.substring(0, 500)}...
                        <br><small>Tempo: ${duration}ms | Model: ${data.model || 'N/A'}</small>
                    `;

                    results.push({
                        id: q.id,
                        category: q.category,
                        question: q.text,
                        response: data.response,
                        success: true,
                        duration_ms: duration,
                        timestamp: new Date().toISOString()
                    });

                    document.getElementById('successes').textContent = results.filter(r => r.success).length;
                } else {
                    questionEl.classList.add('error');
                    responseTextEl.innerHTML = `<span class="status-icon">‚ùå</span> Errore: ${data.error || 'Unknown error'}`;

                    results.push({
                        id: q.id,
                        category: q.category,
                        question: q.text,
                        success: false,
                        error: data.error || 'Unknown error',
                        duration_ms: duration,
                        timestamp: new Date().toISOString()
                    });
                }
            } catch (error) {
                const endTime = Date.now();
                const duration = endTime - startTime;
                totalTime += duration;

                questionEl.classList.remove('active');
                questionEl.classList.add('error');
                responseTextEl.innerHTML = `<span class="status-icon">‚ùå</span> Errore: ${error.message}`;

                results.push({
                    id: q.id,
                    category: q.category,
                    question: q.text,
                    success: false,
                    error: error.message,
                    duration_ms: duration,
                    timestamp: new Date().toISOString()
                });
            }

            updateStats();
            questionEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Update statistics
        function updateStats() {
            const completed = results.length;
            const successes = results.filter(r => r.success).length;
            const avgTime = totalTime / completed;
            const progress = (completed / questions.length) * 100;

            document.getElementById('completed').textContent = completed;
            document.getElementById('successes').textContent = successes;
            document.getElementById('avgTime').textContent = avgTime > 0 ? `${Math.round(avgTime / 1000)}s` : '-';

            const progressFill = document.getElementById('progressFill');
            progressFill.style.width = `${progress}%`;
            progressFill.textContent = `${Math.round(progress)}%`;
        }

        // Pause test
        function pauseTest() {
            isPaused = true;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('startBtn').disabled = false;
            document.getElementById('startBtn').textContent = '‚ñ∂Ô∏è Riprendi Test';
        }

        // Finish test
        function finishTest() {
            isRunning = false;
            document.getElementById('startBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('exportBtn').disabled = false;

            const successes = results.filter(r => r.success).length;
            const successRate = (successes / questions.length * 100).toFixed(1);

            alert(`üéâ Test completato!\n\nSuccessi: ${successes}/${questions.length} (${successRate}%)\nTempo totale: ${(totalTime / 1000).toFixed(1)}s\nTempo medio: ${Math.round(totalTime / questions.length / 1000)}s`);
        }

        // Export results
        function exportResults() {
            const output = {
                metadata: {
                    test_name: 'ZANTARA Business Test - 30 Domande Alta Difficolt√†',
                    timestamp: new Date().toISOString(),
                    total_questions: questions.length
                },
                statistics: {
                    total: questions.length,
                    completed: results.length,
                    successes: results.filter(r => r.success).length,
                    failures: results.filter(r => !r.success).length,
                    success_rate: ((results.filter(r => r.success).length / questions.length) * 100).toFixed(2) + '%',
                    total_time_ms: totalTime,
                    avg_time_ms: Math.round(totalTime / results.length),
                    categories: {
                        immigration: results.filter(r => r.category === 'immigration').length,
                        business: results.filter(r => r.category === 'business').length,
                        tax: results.filter(r => r.category === 'tax').length
                    }
                },
                results: results
            };

            const blob = new Blob([JSON.stringify(output, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `zantara-business-test-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Utility
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
